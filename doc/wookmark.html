<!DOCTYPE html>

<html>
<head>
  <title>wookmark.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>wookmark.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/*!
  jQuery Wookmark plugin
  @name wookmark.js
  @author Christoph Ono (chri@sto.ph or @gbks)
  @author Sebastian Helzle (sebastian@helzle.net or @sebobo)
  @version 2.0.0
  @date 08/27/2014
  @category jQuery plugin
  @copyright (c) 2009-2014 Christoph Ono (www.wookmark.com)
  @license Licensed under the MIT (http://www.opensource.org/licenses/mit-license.php) license.
*/</span>
(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(factory)</span> </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> define === <span class="hljs-string">'function'</span> &amp;&amp; define.amd)
    define([<span class="hljs-string">'jquery'</span>], factory);
  <span class="hljs-keyword">else</span>
    factory(jQuery, <span class="hljs-built_in">window</span>, <span class="hljs-built_in">document</span>);
}(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">($, window, document)</span> </span>{
  <span class="hljs-keyword">var</span> Wookmark, defaultOptions, __bind;

  __bind = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(fn, me)</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">return</span> fn.apply(me, <span class="hljs-built_in">arguments</span>);
    };
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>Wookmark default options</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  defaultOptions = {
    align: <span class="hljs-string">'center'</span>,
    autoResize: <span class="hljs-literal">false</span>,
    comparator: <span class="hljs-literal">null</span>,
    container: <span class="hljs-built_in">document</span>.body,
    direction: <span class="hljs-literal">undefined</span>,
    ignoreInactiveItems: <span class="hljs-literal">true</span>,
    itemWidth: <span class="hljs-number">0</span>,
    fillEmptySpace: <span class="hljs-literal">false</span>,
    flexibleWidth: <span class="hljs-number">0</span>,
    offset: <span class="hljs-number">2</span>,
    outerOffset: <span class="hljs-number">0</span>,
    onLayoutChanged: <span class="hljs-literal">undefined</span>,
    possibleFilters: [],
    resizeDelay: <span class="hljs-number">50</span>,
    verticalOffset: <span class="hljs-literal">undefined</span>
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>Function for executing css writes to dom on the next animation frame if supported</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">var</span> executeNextFrame = <span class="hljs-built_in">window</span>.requestAnimationFrame || <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(callback)</span> </span>{callback();};

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bulkUpdateCSS</span><span class="hljs-params">(data)</span> </span>{
    executeNextFrame(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">var</span> i, item;
      <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; data.length; i++) {
        item = data[i];
        item.obj.css(item.css);
      }
    });
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cleanFilterName</span><span class="hljs-params">(filterName)</span> </span>{
    <span class="hljs-keyword">return</span> $.trim(filterName).toLowerCase();
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addEventListener</span><span class="hljs-params">(el, eventName, handler)</span> </span>{
    <span class="hljs-keyword">if</span> (el.addEventListener) {
      el.addEventListener(eventName, handler);
    } <span class="hljs-keyword">else</span> {
      el.attachEvent(<span class="hljs-string">'on'</span> + eventName, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
        handler.call(el);
      });
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">removeEventListener</span><span class="hljs-params">(el, eventName, handler)</span> </span>{
    <span class="hljs-keyword">if</span> (el.removeEventListener)
      el.removeEventListener(eventName, handler);
    <span class="hljs-keyword">else</span>
      el.detachEvent(<span class="hljs-string">'on'</span> + eventName, handler);
  }</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Main wookmark plugin class</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Wookmark = (<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Wookmark</span><span class="hljs-params">(wrapper, options)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>Instance variables.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.wrapper = wrapper;
      <span class="hljs-keyword">this</span>.columns = <span class="hljs-keyword">this</span>.containerWidth = <span class="hljs-keyword">this</span>.resizeTimer = <span class="hljs-literal">null</span>;
      <span class="hljs-keyword">this</span>.activeItemCount = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">this</span>.placeholders = [];</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Bind instance methods</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.initItems = __bind(<span class="hljs-keyword">this</span>.initItems, <span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">this</span>.update = __bind(<span class="hljs-keyword">this</span>.update, <span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">this</span>.onResize = __bind(<span class="hljs-keyword">this</span>.onResize, <span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">this</span>.onRefresh = __bind(<span class="hljs-keyword">this</span>.onRefresh, <span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">this</span>.getItemWidth = __bind(<span class="hljs-keyword">this</span>.getItemWidth, <span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">this</span>.layout = __bind(<span class="hljs-keyword">this</span>.layout, <span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">this</span>.layoutFull = __bind(<span class="hljs-keyword">this</span>.layoutFull, <span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">this</span>.layoutColumns = __bind(<span class="hljs-keyword">this</span>.layoutColumns, <span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">this</span>.filter = __bind(<span class="hljs-keyword">this</span>.filter, <span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">this</span>.clear = __bind(<span class="hljs-keyword">this</span>.clear, <span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">this</span>.getActiveItems = __bind(<span class="hljs-keyword">this</span>.getActiveItems, <span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">this</span>.refreshPlaceholders = __bind(<span class="hljs-keyword">this</span>.refreshPlaceholders, <span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">this</span>.sortElements = __bind(<span class="hljs-keyword">this</span>.sortElements, <span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">this</span>.updateFilterClasses = __bind(<span class="hljs-keyword">this</span>.updateFilterClasses, <span class="hljs-keyword">this</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>Initialize items</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.initItems();</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Initial update of the filter classes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.updateFilterClasses();</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Listen to resize event if requested.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.autoResize) {
        <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">'resize.wookmark'</span>, <span class="hljs-keyword">this</span>.onResize);
      }</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Listen to refresh event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.container.addEventListener(<span class="hljs-string">'refreshWookmark'</span>, <span class="hljs-keyword">this</span>.onRefresh);</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Initial update and layout</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.update(options);
    }

    Wookmark.prototype.initItems = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">var</span> items = [], children = <span class="hljs-keyword">this</span>.wrapper.children;
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = children.length; i--;){</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Skip comment nodes on IE8</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (children[i].nodeType != <span class="hljs-number">8</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Show item</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          children[i].style.display = <span class="hljs-string">''</span>;
          items.unshift(children[i]);
        }
      }
      <span class="hljs-keyword">this</span>.items = items;
    };

    Wookmark.prototype.updateFilterClasses = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Collect filter data</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, j = <span class="hljs-number">0</span>, k = <span class="hljs-number">0</span>, filterClasses = {}, itemFilterClasses,
          item, filterClass, possibleFilters = <span class="hljs-keyword">this</span>.possibleFilters, possibleFilter;

      <span class="hljs-keyword">for</span> (; i &lt; <span class="hljs-keyword">this</span>.items.length; i++) {
        item = <span class="hljs-keyword">this</span>.items[i];</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>Read filter classes and globally store each filter class as object and the fitting items in the array</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        itemFilterClasses = item.getAttribute(<span class="hljs-string">'data-filter-class'</span>);
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> itemFilterClasses == <span class="hljs-string">'object'</span> &amp;&amp; itemFilterClasses.length &gt; <span class="hljs-number">0</span>) {
          <span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; itemFilterClasses.length; j++) {
            filterClass = cleanFilterName(itemFilterClasses[j]);

            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(filterClasses[filterClass]) === <span class="hljs-string">'undefined'</span>) {
              filterClasses[filterClass] = [];
            }
            filterClasses[filterClass].push(item[<span class="hljs-number">0</span>]);
          }
        }
      }

      <span class="hljs-keyword">for</span> (; k &lt; possibleFilters.length; k++) {
        possibleFilter = cleanFilterName(possibleFilters[k]);
        <span class="hljs-keyword">if</span> (!(possibleFilter <span class="hljs-keyword">in</span> filterClasses)) {
          filterClasses[possibleFilter] = [];
        }
      }

      <span class="hljs-keyword">this</span>.filterClasses = filterClasses;
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>Method for updating the plugins options</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Wookmark.prototype.update = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{
      <span class="hljs-keyword">this</span>.itemHeightsDirty = <span class="hljs-literal">true</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>Overwrite non existing instance variables with the ones from options or the defaults</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> defaultOptions) {
        <span class="hljs-keyword">if</span> (defaultOptions.hasOwnProperty(key)) {
          <span class="hljs-keyword">if</span> (options.hasOwnProperty(key))
            <span class="hljs-keyword">this</span>[key] = options[key];
          <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.hasOwnProperty(key))
            <span class="hljs-keyword">this</span>[key] = defaultOptions[key];
        }
      }</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>Vertical offset uses a fallback to offset</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.verticalOffset = <span class="hljs-keyword">this</span>.verticalOffset || <span class="hljs-keyword">this</span>.offset;

      <span class="hljs-keyword">this</span>.layout(<span class="hljs-literal">true</span>);
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>This timer ensures that layout is not continuously called as window is being dragged.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Wookmark.prototype.onResize = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
      clearTimeout(<span class="hljs-keyword">this</span>.resizeTimer);
      <span class="hljs-keyword">this</span>.itemHeightsDirty = <span class="hljs-keyword">this</span>.flexibleWidth !== <span class="hljs-number">0</span>;
      <span class="hljs-keyword">this</span>.resizeTimer = setTimeout(<span class="hljs-keyword">this</span>.layout, <span class="hljs-keyword">this</span>.resizeDelay);
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>Marks the items heights as dirty and does a relayout</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Wookmark.prototype.onRefresh = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">this</span>.itemHeightsDirty = <span class="hljs-literal">true</span>;
      <span class="hljs-keyword">this</span>.layout();
    };

    <span class="hljs-comment">/**
     * Filters the active items with the given string filters.
     * @param filters array of string
     * @param mode 'or' or 'and'
     */</span>
    Wookmark.prototype.filter = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(filters, mode, dryRun)</span> </span>{
      <span class="hljs-keyword">var</span> activeFilters = [], activeFiltersLength, activeItems = $(),
          i, j, k, filter;

      filters = filters || [];
      mode = mode || <span class="hljs-string">'or'</span>;
      dryRun = dryRun || <span class="hljs-literal">false</span>;

      <span class="hljs-keyword">if</span> (filters.length) {</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>Collect active filters</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; filters.length; i++) {
          filter = cleanFilterName(filters[i]);
          <span class="hljs-keyword">if</span> (filter <span class="hljs-keyword">in</span> <span class="hljs-keyword">this</span>.filterClasses) {
            activeFilters.push(<span class="hljs-keyword">this</span>.filterClasses[filter]);
          }
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>Get items for active filters with the selected mode</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        activeFiltersLength = activeFilters.length;
        <span class="hljs-keyword">if</span> (mode == <span class="hljs-string">'or'</span> || activeFiltersLength == <span class="hljs-number">1</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>Set all items in all active filters active</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; activeFiltersLength; i++) {
            activeItems = activeItems.add(activeFilters[i]);
          }
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (mode == <span class="hljs-string">'and'</span>) {
          <span class="hljs-keyword">var</span> shortestFilter = activeFilters[<span class="hljs-number">0</span>],
              itemValid = <span class="hljs-literal">true</span>, foundInFilter,
              currentItem, currentFilter;</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>Find shortest filter class</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">for</span> (i = <span class="hljs-number">1</span>; i &lt; activeFiltersLength; i++) {
            <span class="hljs-keyword">if</span> (activeFilters[i].length &lt; shortestFilter.length) {
              shortestFilter = activeFilters[i];
            }
          }</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Iterate over shortest filter and find elements in other filter classes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          shortestFilter = shortestFilter || [];
          <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; shortestFilter.length; i++) {
            currentItem = shortestFilter[i];
            itemValid = <span class="hljs-literal">true</span>;

            <span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; activeFilters.length &amp;&amp; itemValid; j++) {
              currentFilter = activeFilters[j];
              <span class="hljs-keyword">if</span> (shortestFilter == currentFilter) <span class="hljs-keyword">continue</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>Search for current item in each active filter class</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>              <span class="hljs-keyword">for</span> (k = <span class="hljs-number">0</span>, foundInFilter = <span class="hljs-literal">false</span>; k &lt; currentFilter.length &amp;&amp; !foundInFilter; k++) {
                foundInFilter = currentFilter[k] == currentItem;
              }
              itemValid &amp;= foundInFilter;
            }
            <span class="hljs-keyword">if</span> (itemValid)
              activeItems.push(shortestFilter[i]);
          }
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>Hide inactive items</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (!dryRun)
          <span class="hljs-keyword">this</span>.handler.not(activeItems).addClass(<span class="hljs-string">'inactive'</span>);
      } <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>Show all items if no filter is selected</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        activeItems = <span class="hljs-keyword">this</span>.handler;
      }</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>Show active items</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (!dryRun) {
        activeItems.removeClass(<span class="hljs-string">'inactive'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>Unset columns and refresh grid for a full layout</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>.columns = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.layout();
      }
      <span class="hljs-keyword">return</span> activeItems;
    };

    <span class="hljs-comment">/**
     * Creates or updates existing placeholders to create columns of even height
     */</span>
    Wookmark.prototype.refreshPlaceholders = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(columnWidth, sideOffset)</span> </span>{
      <span class="hljs-keyword">var</span> i = <span class="hljs-keyword">this</span>.placeholders.length,
          $placeholder, $lastColumnItem,
          columnsLength = <span class="hljs-keyword">this</span>.columns.length, column,
          height, top, innerOffset,
          containerHeight = <span class="hljs-keyword">this</span>.container.innerHeight();

      <span class="hljs-keyword">for</span> (; i &lt; columnsLength; i++) {
        $placeholder = $(<span class="hljs-string">'&lt;div class="wookmark-placeholder"/&gt;'</span>).appendTo(<span class="hljs-keyword">this</span>.container);
        <span class="hljs-keyword">this</span>.placeholders.push($placeholder);
      }

      innerOffset = <span class="hljs-keyword">this</span>.offset + <span class="hljs-built_in">parseInt</span>(<span class="hljs-keyword">this</span>.placeholders[<span class="hljs-number">0</span>].css(<span class="hljs-string">'borderLeftWidth'</span>), <span class="hljs-number">10</span>) * <span class="hljs-number">2</span>;

      <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.placeholders.length; i++) {
        $placeholder = <span class="hljs-keyword">this</span>.placeholders[i];
        column = <span class="hljs-keyword">this</span>.columns[i];

        <span class="hljs-keyword">if</span> (i &gt;= columnsLength || !column[column.length - <span class="hljs-number">1</span>]) {
          $placeholder.css(<span class="hljs-string">'display'</span>, <span class="hljs-string">'none'</span>);
        } <span class="hljs-keyword">else</span> {
          $lastColumnItem = column[column.length - <span class="hljs-number">1</span>];
          <span class="hljs-keyword">if</span> (!$lastColumnItem) <span class="hljs-keyword">continue</span>;
          top = $lastColumnItem.data(<span class="hljs-string">'wookmark-top'</span>) + $lastColumnItem.data(<span class="hljs-string">'wookmark-height'</span>) + <span class="hljs-keyword">this</span>.verticalOffset;
          height = containerHeight - top - innerOffset;

          $placeholder.css({
            position: <span class="hljs-string">'absolute'</span>,
            display: height &gt; <span class="hljs-number">0</span> ? <span class="hljs-string">'block'</span> : <span class="hljs-string">'none'</span>,
            left: i * columnWidth + sideOffset,
            top: top,
            width: columnWidth - innerOffset,
            height: height
          });
        }
      }
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>Method the get active items which are not disabled and visible</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Wookmark.prototype.getActiveItems = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.ignoreInactiveItems ? <span class="hljs-keyword">this</span>.handler.not(<span class="hljs-string">'.inactive'</span>) : <span class="hljs-keyword">this</span>.handler;
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>Method to get the standard item width</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Wookmark.prototype.getItemWidth = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">var</span> itemWidth = <span class="hljs-keyword">this</span>.itemWidth,
          innerWidth = <span class="hljs-keyword">this</span>.container.width() - <span class="hljs-number">2</span> * <span class="hljs-keyword">this</span>.outerOffset,
          firstElement = <span class="hljs-keyword">this</span>.handler.eq(<span class="hljs-number">0</span>),
          flexibleWidth = <span class="hljs-keyword">this</span>.flexibleWidth;

      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.itemWidth === <span class="hljs-literal">undefined</span> || <span class="hljs-keyword">this</span>.itemWidth === <span class="hljs-number">0</span> &amp;&amp; !<span class="hljs-keyword">this</span>.flexibleWidth) {
        itemWidth = firstElement.outerWidth();
      }
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.itemWidth == <span class="hljs-string">'string'</span> &amp;&amp; <span class="hljs-keyword">this</span>.itemWidth.indexOf(<span class="hljs-string">'%'</span>) &gt;= <span class="hljs-number">0</span>) {
        itemWidth = <span class="hljs-built_in">parseFloat</span>(<span class="hljs-keyword">this</span>.itemWidth) / <span class="hljs-number">100</span> * innerWidth;
      }</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>Calculate flexible item width if option is set</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (flexibleWidth) {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> flexibleWidth == <span class="hljs-string">'string'</span> &amp;&amp; flexibleWidth.indexOf(<span class="hljs-string">'%'</span>) &gt;= <span class="hljs-number">0</span>) {
          flexibleWidth = <span class="hljs-built_in">parseFloat</span>(flexibleWidth) / <span class="hljs-number">100</span> * innerWidth;
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>Find highest column count</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">var</span> paddedInnerWidth = (innerWidth + <span class="hljs-keyword">this</span>.offset),
            flexibleColumns = ~~(<span class="hljs-number">0.5</span> + paddedInnerWidth / (flexibleWidth + <span class="hljs-keyword">this</span>.offset)),
            fixedColumns = ~~(paddedInnerWidth / (itemWidth + <span class="hljs-keyword">this</span>.offset)),
            columns = <span class="hljs-built_in">Math</span>.max(flexibleColumns, fixedColumns),
            columnWidth = <span class="hljs-built_in">Math</span>.min(flexibleWidth, ~~((innerWidth - (columns - <span class="hljs-number">1</span>) * <span class="hljs-keyword">this</span>.offset) / columns));

        itemWidth = <span class="hljs-built_in">Math</span>.max(itemWidth, columnWidth);</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>Stretch items to fill calculated width</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>.handler.css(<span class="hljs-string">'width'</span>, itemWidth);
      }

      <span class="hljs-keyword">return</span> itemWidth;
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>Main layout method.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Wookmark.prototype.layout = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(force)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>Do nothing if container isn’t visible</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.container.is(<span class="hljs-string">':visible'</span>)) <span class="hljs-keyword">return</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>Calculate basic layout parameters.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> columnWidth = <span class="hljs-keyword">this</span>.getItemWidth() + <span class="hljs-keyword">this</span>.offset,
          containerWidth = <span class="hljs-keyword">this</span>.container.width(),
          innerWidth = containerWidth - <span class="hljs-number">2</span> * <span class="hljs-keyword">this</span>.outerOffset,
          columns = ~~((innerWidth + <span class="hljs-keyword">this</span>.offset) / columnWidth),
          offset = <span class="hljs-number">0</span>, maxHeight = <span class="hljs-number">0</span>, i = <span class="hljs-number">0</span>,
          activeItems = <span class="hljs-keyword">this</span>.getActiveItems(),
          activeItemsLength = activeItems.length,
          $item;</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>Cache item height</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.itemHeightsDirty || !<span class="hljs-keyword">this</span>.container.data(<span class="hljs-string">'itemHeightsInitialized'</span>)) {
        <span class="hljs-keyword">for</span> (; i &lt; activeItemsLength; i++) {
          $item = activeItems.eq(i);
          $item.data(<span class="hljs-string">'wookmark-height'</span>, $item.outerHeight());
        }
        <span class="hljs-keyword">this</span>.itemHeightsDirty = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">this</span>.container.data(<span class="hljs-string">'itemHeightsInitialized'</span>, <span class="hljs-literal">true</span>);
      }</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p>Use less columns if there are to few items</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      columns = <span class="hljs-built_in">Math</span>.max(<span class="hljs-number">1</span>, <span class="hljs-built_in">Math</span>.min(columns, activeItemsLength));</pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p>Calculate the offset based on the alignment of columns to the parent container</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      offset = <span class="hljs-keyword">this</span>.outerOffset;
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.align == <span class="hljs-string">'center'</span>) {
        offset += ~~(<span class="hljs-number">0.5</span> + (innerWidth - (columns * columnWidth - <span class="hljs-keyword">this</span>.offset)) &gt;&gt; <span class="hljs-number">1</span>);
      }</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <p>Get direction for positioning</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.direction = <span class="hljs-keyword">this</span>.direction || (<span class="hljs-keyword">this</span>.align == <span class="hljs-string">'right'</span> ? <span class="hljs-string">'right'</span> : <span class="hljs-string">'left'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <p>If container and column count hasn’t changed, we can only update the columns.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (!force &amp;&amp; <span class="hljs-keyword">this</span>.columns !== <span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-keyword">this</span>.columns.length == columns &amp;&amp; <span class="hljs-keyword">this</span>.activeItemCount == activeItemsLength) {
        maxHeight = <span class="hljs-keyword">this</span>.layoutColumns(columnWidth, offset);
      } <span class="hljs-keyword">else</span> {
        maxHeight = <span class="hljs-keyword">this</span>.layoutFull(columnWidth, columns, offset);
      }
      <span class="hljs-keyword">this</span>.activeItemCount = activeItemsLength;</pre></div></div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              <p>Set container height to height of the grid.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.container.css(<span class="hljs-string">'height'</span>, maxHeight);</pre></div></div>
            
        </li>
        
        
        <li id="section-45">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-45">&#182;</a>
              </div>
              <p>Update placeholders</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.fillEmptySpace) {
        <span class="hljs-keyword">this</span>.refreshPlaceholders(columnWidth, offset);
      }

      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.onLayoutChanged !== <span class="hljs-literal">undefined</span> &amp;&amp; <span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.onLayoutChanged === <span class="hljs-string">'function'</span>) {
        <span class="hljs-keyword">this</span>.onLayoutChanged();
      }
    };

    <span class="hljs-comment">/**
     * Sort elements with configurable comparator
     */</span>
    Wookmark.prototype.sortElements = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(elements)</span> </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span>(<span class="hljs-keyword">this</span>.comparator) === <span class="hljs-string">'function'</span> ? elements.sort(<span class="hljs-keyword">this</span>.comparator) : elements;
    };

    <span class="hljs-comment">/**
     * Perform a full layout update.
     */</span>
    Wookmark.prototype.layoutFull = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(columnWidth, columns, offset)</span> </span>{
      <span class="hljs-keyword">var</span> $item, i = <span class="hljs-number">0</span>, k = <span class="hljs-number">0</span>,
          activeItems = $.makeArray(<span class="hljs-keyword">this</span>.getActiveItems()),
          length = activeItems.length,
          shortest = <span class="hljs-literal">null</span>, shortestIndex = <span class="hljs-literal">null</span>,
          sideOffset, heights = [], itemBulkCSS = [],
          leftAligned = <span class="hljs-keyword">this</span>.align == <span class="hljs-string">'left'</span> ? <span class="hljs-literal">true</span> : <span class="hljs-literal">false</span>;

      <span class="hljs-keyword">this</span>.columns = [];</pre></div></div>
            
        </li>
        
        
        <li id="section-46">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-46">&#182;</a>
              </div>
              <p>Sort elements before layouting</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      activeItems = <span class="hljs-keyword">this</span>.sortElements(activeItems);</pre></div></div>
            
        </li>
        
        
        <li id="section-47">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-47">&#182;</a>
              </div>
              <p>Prepare arrays to store height of columns and items.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">while</span> (heights.length &lt; columns) {
        heights.push(<span class="hljs-keyword">this</span>.outerOffset);
        <span class="hljs-keyword">this</span>.columns.push([]);
      }</pre></div></div>
            
        </li>
        
        
        <li id="section-48">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-48">&#182;</a>
              </div>
              <p>Loop over items.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">for</span> (; i &lt; length; i++ ) {
        $item = $(activeItems[i]);</pre></div></div>
            
        </li>
        
        
        <li id="section-49">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-49">&#182;</a>
              </div>
              <p>Find the shortest column.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        shortest = heights[<span class="hljs-number">0</span>];
        shortestIndex = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (k = <span class="hljs-number">0</span>; k &lt; columns; k++) {
          <span class="hljs-keyword">if</span> (heights[k] &lt; shortest) {
            shortest = heights[k];
            shortestIndex = k;
          }
        }
        $item.data(<span class="hljs-string">'wookmark-top'</span>, shortest);</pre></div></div>
            
        </li>
        
        
        <li id="section-50">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-50">&#182;</a>
              </div>
              <p>stick to left side if alignment is left and this is the first column</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        sideOffset = offset;
        <span class="hljs-keyword">if</span> (shortestIndex &gt; <span class="hljs-number">0</span> || !leftAligned)
          sideOffset += shortestIndex * columnWidth;</pre></div></div>
            
        </li>
        
        
        <li id="section-51">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-51">&#182;</a>
              </div>
              <p>Position the item.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        (itemBulkCSS[i] = {
          obj: $item,
          css: {
            position: <span class="hljs-string">'absolute'</span>,
            top: shortest
          }
        }).css[<span class="hljs-keyword">this</span>.direction] = sideOffset;</pre></div></div>
            
        </li>
        
        
        <li id="section-52">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-52">&#182;</a>
              </div>
              <p>Update column height and store item in shortest column</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        heights[shortestIndex] += $item.data(<span class="hljs-string">'wookmark-height'</span>) + <span class="hljs-keyword">this</span>.verticalOffset;
        <span class="hljs-keyword">this</span>.columns[shortestIndex].push($item);
      }

      bulkUpdateCSS(itemBulkCSS);</pre></div></div>
            
        </li>
        
        
        <li id="section-53">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-53">&#182;</a>
              </div>
              <p>Return longest column</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.max.apply(<span class="hljs-built_in">Math</span>, heights);
    };

    <span class="hljs-comment">/**
     * This layout method only updates the vertical position of the
     * existing column assignments.
     */</span>
    Wookmark.prototype.layoutColumns = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(columnWidth, offset)</span> </span>{
      <span class="hljs-keyword">var</span> heights = [], itemBulkCSS = [],
          i = <span class="hljs-number">0</span>, k = <span class="hljs-number">0</span>, j = <span class="hljs-number">0</span>, currentHeight,
          column, $item, itemData, sideOffset;

      <span class="hljs-keyword">for</span> (; i &lt; <span class="hljs-keyword">this</span>.columns.length; i++) {
        heights.push(<span class="hljs-keyword">this</span>.outerOffset);
        column = <span class="hljs-keyword">this</span>.columns[i];
        sideOffset = i * columnWidth + offset;
        currentHeight = heights[i];

        <span class="hljs-keyword">for</span> (k = <span class="hljs-number">0</span>; k &lt; column.length; k++, j++) {
          $item = column[k].data(<span class="hljs-string">'wookmark-top'</span>, currentHeight);
          (itemBulkCSS[j] = {
            obj: $item,
            css: {
              top: currentHeight
            }
          }).css[<span class="hljs-keyword">this</span>.direction] = sideOffset;

          currentHeight += $item.data(<span class="hljs-string">'wookmark-height'</span>) + <span class="hljs-keyword">this</span>.verticalOffset;
        }
        heights[i] = currentHeight;
      }

      bulkUpdateCSS(itemBulkCSS);</pre></div></div>
            
        </li>
        
        
        <li id="section-54">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-54">&#182;</a>
              </div>
              <p>Return longest column</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.max.apply(<span class="hljs-built_in">Math</span>, heights);
    };

    <span class="hljs-comment">/**
     * Clear event listeners and time outs and the instance itself
     */</span>
    Wookmark.prototype.clear = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
      clearTimeout(<span class="hljs-keyword">this</span>.resizeTimer);
      $<span class="hljs-built_in">window</span>.unbind(<span class="hljs-string">'resize.wookmark'</span>, <span class="hljs-keyword">this</span>.onResize);
      <span class="hljs-keyword">this</span>.container.unbind(<span class="hljs-string">'refreshWookmark'</span>, <span class="hljs-keyword">this</span>.onRefresh);
      <span class="hljs-keyword">this</span>.handler.wookmarkInstance = <span class="hljs-literal">null</span>;
    };

    <span class="hljs-keyword">return</span> Wookmark;
  })();

  $.fn.wookmark = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.length &gt; <span class="hljs-number">1</span>) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-keyword">this</span>.length - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
        <span class="hljs-keyword">this</span>[i].wookmark(options);
      };
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.length == <span class="hljs-number">1</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-55">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-55">&#182;</a>
              </div>
              <p>Create a wookmark instance or update an existing one</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.wookmarkInstance) {
        <span class="hljs-keyword">this</span>.wookmarkInstance = <span class="hljs-keyword">new</span> Wookmark(<span class="hljs-keyword">this</span>, options || {});
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">this</span>.wookmarkInstance.update(options || {});
      }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  };

  <span class="hljs-built_in">window</span>.Wookmark = Wookmark;
}));</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
